<Window x:Class="WorkshopTracker.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:conv="clr-namespace:WorkshopTracker.Converters"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Workshop Tracker"
        Height="800"
        Width="1400"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Date colouring -->
        <conv:DateDueToBrushConverter x:Key="DateDueToBrushConverter" />

        <!-- Row style: normal rows white; date-divider rows light grey & non-editable -->
        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="White" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="FontSize" Value="12" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsGroupRow}" Value="True">
                    <Setter Property="Background" Value="#FFDCDCDC" />
                    <Setter Property="FontWeight" Value="Bold" />
                    <!-- prevent editing / selection on divider rows -->
                    <Setter Property="IsHitTestVisible" Value="False" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <DockPanel>

        <!-- Top teal header -->
        <Border DockPanel.Dock="Top"
                Background="#00AAA8"
                Padding="10"
                Height="50">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="Workshop Tracker"
                           Foreground="White"
                           FontSize="20"
                           FontWeight="Bold"
                           VerticalAlignment="Center" />

                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            VerticalAlignment="Center">

                    <!-- Font size selector -->
                    <StackPanel Orientation="Horizontal"
                                Margin="0,0,16,0">
                        <TextBlock Text="Font size:"
                                   Foreground="White"
                                   Margin="0,0,6,0"
                                   VerticalAlignment="Center" />
                        <ComboBox x:Name="FontSizeComboBox"
                                  Width="110"
                                  SelectionChanged="FontSizeComboBox_SelectionChanged">
                            <ComboBoxItem Content="Standard" Tag="12" IsSelected="True" />
                            <ComboBoxItem Content="Medium"   Tag="14" />
                            <ComboBoxItem Content="Large"    Tag="16" />
                        </ComboBox>
                    </StackPanel>

                    <!-- Search -->
                    <StackPanel Orientation="Horizontal"
                                Margin="0,0,16,0">
                        <TextBlock Text="Search:"
                                   Foreground="White"
                                   Margin="0,0,6,0"
                                   VerticalAlignment="Center" />
                        <TextBox x:Name="SearchTextBox"
                                 Width="220"
                                 TextChanged="SearchTextBox_TextChanged" />
                    </StackPanel>

                    <!-- Buttons -->
                    <StackPanel Orientation="Horizontal">
                        <Button Content="Reload"
                                Margin="0,0,6,0"
                                Padding="10,4"
                                Click="Reload_Click" />
                        <Button Content="Save (backup)"
                                Margin="0,0,6,0"
                                Padding="10,4"
                                Click="Save_Click" />
                        <Button Content="Delete row"
                                Padding="10,4"
                                Click="DeleteRow_Click" />
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Status bar -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="Ready" />
            </StatusBarItem>
        </StatusBar>

        <!-- Main content -->
        <TabControl x:Name="WorksTabControl">
            <!-- OPEN WORKS -->
            <TabItem Header="Open Works">
                <Grid>
                    <DataGrid x:Name="OpenGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="False"
                              HeadersVisibility="Column"
                              SelectionMode="Extended"
                              GridLinesVisibility="All"
                              RowEditEnding="DataGrid_RowEditEnding"
                              BeginningEdit="DataGrid_BeginningEdit"
                              AllowDrop="True"
                              Drop="DataGrid_Drop">

                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Add row above" Click="AddRowAbove_Click" />
                                <MenuItem Header="Add row below" Click="AddRowBelow_Click" />
                                <MenuItem Header="Copy row" Click="CopyRow_Click" />
                            </ContextMenu>
                        </DataGrid.ContextMenu>

                        <DataGrid.Columns>

                            <!-- GRAB HANDLE COLUMN -->
                            <DataGridTemplateColumn Header="" Width="24" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="Transparent"
                                                Cursor="SizeAll"
                                                PreviewMouseLeftButtonDown="DragHandle_PreviewMouseLeftButtonDown"
                                                PreviewMouseMove="DragHandle_PreviewMouseMove"
                                                PreviewMouseLeftButtonUp="DragHandle_PreviewMouseLeftButtonUp">
                                            <TextBlock Text="≡"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="Gray" />
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- RETAIL -->
                            <DataGridComboBoxColumn Header="RETAIL"
                                                   Width="60"
                                                   SelectedItemBinding="{Binding Retail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Y</sys:String>
                                        <sys:String>N</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Retail}" Value="Y">
                                                <Setter Property="Background" Value="Orange" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Retail}" Value="N">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <!-- OE -->
                            <DataGridComboBoxColumn Header="OE"
                                                   Width="60"
                                                   SelectedItemBinding="{Binding OE, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Y</sys:String>
                                        <sys:String>N</sys:String>
                                        <sys:String>A/L</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding OE}" Value="Y">
                                                <Setter Property="Background" Value="Orange" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding OE}" Value="N">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding OE}" Value="A/L">
                                                <Setter Property="Background" Value="LightBlue" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <!-- CUSTOMER: highlight yellow for industrial -->
                            <DataGridTextColumn Header="CUSTOMER"
                                                Binding="{Binding Customer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="200">
                                <DataGridTextColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Shaft}" Value="industrial">
                                                <Setter Property="Background" Value="Yellow" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.CellStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="SERIAL"
                                                Binding="{Binding Serial, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="120" />

                            <DataGridTextColumn Header="DAY DUE"
                                                Binding="{Binding DayDue}"
                                                Width="80"
                                                IsReadOnly="True" />

                            <!-- DATE DUE: fully coloured background -->
                            <DataGridTemplateColumn Header="DATE DUE"
                                                    Width="130"
                                                    SortMemberPath="DateDue">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="{Binding DateDue, Converter={StaticResource DateDueToBrushConverter}}">
                                            <DatePicker SelectedDate="{Binding DateDue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        SelectedDateChanged="DateDuePicker_SelectedDateChanged"
                                                        HorizontalContentAlignment="Center"
                                                        Language="en-AU" />
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- STATUS -->
                            <DataGridComboBoxColumn Header="STATUS"
                                                   Width="140"
                                                   SelectedItemBinding="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>quote</sys:String>
                                        <sys:String>picking</sys:String>
                                        <sys:String>assembly</sys:String>
                                        <sys:String>balancing</sys:String>
                                        <sys:String>booked in</sys:String>
                                        <sys:String>paint shop</sys:String>
                                        <sys:String>completed</sys:String>
                                        <sys:String>picked up</sys:String>
                                        <sys:String>cancelled</sys:String>
                                        <sys:String>AWAY</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>

                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <EventSetter Event="Loaded" Handler="StatusComboBox_Loaded"/>
                                        <EventSetter Event="SelectionChanged" Handler="StatusComboBox_SelectionChanged"/>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>

                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="quote">
                                                <Setter Property="Background" Value="LightBlue" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="picking">
                                                <Setter Property="Background" Value="Purple" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="assembly">
                                                <Setter Property="Background" Value="Green" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="balancing">
                                                <Setter Property="Background" Value="Orange" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="booked in">
                                                <Setter Property="Background" Value="Pink" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="paint shop">
                                                <Setter Property="Background" Value="Yellow" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="completed">
                                                <Setter Property="Background" Value="LightGreen" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="picked up">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="cancelled">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="AWAY">
                                                <Setter Property="Background" Value="LightBlue" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <DataGridTextColumn Header="QTY"
                                                Binding="{Binding Qty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="50" />

                            <DataGridTextColumn Header="WHAT IS IT"
                                                Binding="{Binding WhatIsIt, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="200" />

                            <DataGridTextColumn Header="PO"
                                                Binding="{Binding PO, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="120" />

                            <DataGridTextColumn Header="WHAT ARE WE DOING"
                                                Binding="{Binding WhatAreWeDoing, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="250" />

                            <DataGridTextColumn Header="PARTS"
                                                Binding="{Binding Parts, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="200" />

                            <!-- SHAFT -->
                            <DataGridComboBoxColumn Header="SHAFT"
                                                   Width="110"
                                                   SelectedItemBinding="{Binding Shaft, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>domestic</sys:String>
                                        <sys:String>industrial</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Shaft}" Value="domestic">
                                                <Setter Property="Background" Value="White" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Shaft}" Value="industrial">
                                                <Setter Property="Background" Value="LightYellow" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <!-- PRIORITY -->
                            <DataGridComboBoxColumn Header="PRIORITY"
                                                   Width="80"
                                                   SelectedItemBinding="{Binding Priority, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Y</sys:String>
                                        <sys:String>N</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Priority}" Value="Y">
                                                <Setter Property="Background" Value="Green" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Priority}" Value="N">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <DataGridTextColumn Header="LAST USER"
                                                Binding="{Binding LastUser}"
                                                IsReadOnly="True"
                                                Width="120" />

                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <!-- CLOSED WORKS -->
            <TabItem Header="Closed Works">
                <Grid>
                    <DataGrid x:Name="ClosedGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              IsReadOnly="False"
                              HeadersVisibility="Column"
                              SelectionMode="Extended"
                              GridLinesVisibility="All"
                              RowEditEnding="DataGrid_RowEditEnding"
                              BeginningEdit="DataGrid_BeginningEdit"
                              AllowDrop="True"
                              Drop="DataGrid_Drop">

                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Add row above" Click="AddRowAbove_Click" />
                                <MenuItem Header="Add row below" Click="AddRowBelow_Click" />
                                <MenuItem Header="Copy row" Click="CopyRow_Click" />
                            </ContextMenu>
                        </DataGrid.ContextMenu>

                        <DataGrid.Columns>

                            <!-- GRAB HANDLE COLUMN -->
                            <DataGridTemplateColumn Header="" Width="24" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="Transparent"
                                                Cursor="SizeAll"
                                                PreviewMouseLeftButtonDown="DragHandle_PreviewMouseLeftButtonDown"
                                                PreviewMouseMove="DragHandle_PreviewMouseMove"
                                                PreviewMouseLeftButtonUp="DragHandle_PreviewMouseLeftButtonUp">
                                            <TextBlock Text="≡"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="Gray" />
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- RETAIL -->
                            <DataGridComboBoxColumn Header="RETAIL"
                                                   Width="60"
                                                   SelectedItemBinding="{Binding Retail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Y</sys:String>
                                        <sys:String>N</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Retail}" Value="Y">
                                                <Setter Property="Background" Value="Orange" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Retail}" Value="N">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <!-- OE -->
                            <DataGridComboBoxColumn Header="OE"
                                                   Width="60"
                                                   SelectedItemBinding="{Binding OE, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Y</sys:String>
                                        <sys:String>N</sys:String>
                                        <sys:String>A/L</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding OE}" Value="Y">
                                                <Setter Property="Background" Value="Orange" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding OE}" Value="N">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding OE}" Value="A/L">
                                                <Setter Property="Background" Value="LightBlue" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <!-- CUSTOMER -->
                            <DataGridTextColumn Header="CUSTOMER"
                                                Binding="{Binding Customer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="200">
                                <DataGridTextColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Shaft}" Value="industrial">
                                                <Setter Property="Background" Value="Yellow" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.CellStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="SERIAL"
                                                Binding="{Binding Serial, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="120" />

                            <DataGridTextColumn Header="DAY DUE"
                                                Binding="{Binding DayDue}"
                                                Width="80"
                                                IsReadOnly="True" />

                            <!-- DATE DUE -->
                            <DataGridTemplateColumn Header="DATE DUE"
                                                    Width="130"
                                                    SortMemberPath="DateDue">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="{Binding DateDue, Converter={StaticResource DateDueToBrushConverter}}">
                                            <DatePicker SelectedDate="{Binding DateDue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        SelectedDateChanged="DateDuePicker_SelectedDateChanged"
                                                        HorizontalContentAlignment="Center"
                                                        Language="en-AU" />
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- STATUS -->
                            <DataGridComboBoxColumn Header="STATUS"
                                                   Width="140"
                                                   SelectedItemBinding="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>quote</sys:String>
                                        <sys:String>picking</sys:String>
                                        <sys:String>assembly</sys:String>
                                        <sys:String>balancing</sys:String>
                                        <sys:String>booked in</sys:String>
                                        <sys:String>paint shop</sys:String>
                                        <sys:String>completed</sys:String>
                                        <sys:String>picked up</sys:String>
                                        <sys:String>cancelled</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>

                                <DataGridComboBoxColumn.EditingElementStyle>
                                    <Style TargetType="ComboBox">
                                        <EventSetter Event="Loaded" Handler="StatusComboBox_Loaded"/>
                                        <EventSetter Event="SelectionChanged" Handler="StatusComboBox_SelectionChanged"/>
                                    </Style>
                                </DataGridComboBoxColumn.EditingElementStyle>

                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="quote">
                                                <Setter Property="Background" Value="LightBlue" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="picking">
                                                <Setter Property="Background" Value="Purple" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="assembly">
                                                <Setter Property="Background" Value="Green" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="balancing">
                                                <Setter Property="Background" Value="Orange" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="booked in">
                                                <Setter Property="Background" Value="Pink" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="paint shop">
                                                <Setter Property="Background" Value="Yellow" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="completed">
                                                <Setter Property="Background" Value="LightGreen" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="picked up">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="cancelled">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <DataGridTextColumn Header="QTY"
                                                Binding="{Binding Qty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="50" />

                            <DataGridTextColumn Header="WHAT IS IT"
                                                Binding="{Binding WhatIsIt, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="200" />

                            <DataGridTextColumn Header="PO"
                                                Binding="{Binding PO, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="120" />

                            <DataGridTextColumn Header="WHAT ARE WE DOING"
                                                Binding="{Binding WhatAreWeDoing, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="250" />

                            <DataGridTextColumn Header="PARTS"
                                                Binding="{Binding Parts, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Width="200" />

                            <!-- SHAFT -->
                            <DataGridComboBoxColumn Header="SHAFT"
                                                   Width="110"
                                                   SelectedItemBinding="{Binding Shaft, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>domestic</sys:String>
                                        <sys:String>industrial</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Shaft}" Value="domestic">
                                                <Setter Property="Background" Value="White" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Shaft}" Value="industrial">
                                                <Setter Property="Background" Value="LightYellow" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <!-- PRIORITY -->
                            <DataGridComboBoxColumn Header="PRIORITY"
                                                   Width="80"
                                                   SelectedItemBinding="{Binding Priority, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Y</sys:String>
                                        <sys:String>N</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Priority}" Value="Y">
                                                <Setter Property="Background" Value="Green" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Priority}" Value="N">
                                                <Setter Property="Background" Value="Red" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridComboBoxColumn.CellStyle>
                            </DataGridComboBoxColumn>

                            <DataGridTextColumn Header="LAST USER"
                                                Binding="{Binding LastUser}"
                                                IsReadOnly="True"
                                                Width="120" />

                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

    </DockPanel>
</Window>
